<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Bet Tracker (Local)</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 24px; }
    .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
    .card { border: 1px solid #ddd; border-radius: 10px; padding: 14px; }
    .stats { display:flex; gap:14px; flex-wrap:wrap; }
    .pill { padding: 6px 10px; border-radius: 999px; border: 1px solid #ddd; }
    table { width:100%; border-collapse: collapse; }
    th, td { padding: 10px; border-bottom: 1px solid #eee; vertical-align: top; }
    .muted { color:#666; font-size: 12px; }
    .actions { display:flex; gap: 8px; }
  </style>
</head>
<body>
  <h1>Bet Tracker (Local)</h1>
  <div class="actions" style="margin-bottom: 12px;">
    <a href="/espn/scoreboard">ESPN Scoreboard</a>
    <a href="/ui/settings">Auto Picks Settings</a>
  </div>

  <div class="stats">
    <div class="pill">Total: <b>{{ stats.total }}</b></div>
    <div class="pill">BET: <b>{{ stats.bet }}</b></div>
    <div class="pill">LEAN: <b>{{ stats.lean }}</b></div>
    <div class="pill">NO_BET: <b>{{ stats.no_bet }}</b></div>
  </div>

  <div class="grid" style="margin-top:16px;">
    <div class="card">
      <h3>Auto picks recientes</h3>
      <table>
        <thead>
          <tr>
            <th>Juego</th>
            <th>Resultado</th>
            <th>Market</th>
            <th>Selección</th>
            <th>EV</th>
            <th>Conf.</th>
          </tr>
        </thead>
        <tbody>
          {% for pick in picks %}
            {% set game = games.get(pick.game_id) %}
            <tr>
              <td>
                {% if game %}
                  {{ game.home_team }} vs {{ game.away_team }}
                  <div class="muted">{{ game.league }} · {{ game.start_time_utc }}</div>
                {% else %}
                  Game #{{ pick.game_id }}
                {% endif %}
              </td>
              <td><b>{{ pick.result }}</b> {{ pick.emoji }}</td>
              <td>{{ pick.market or '-' }}</td>
              <td>{{ pick.selection or '-' }}</td>
              <td>{{ pick.ev if pick.ev is not none else '-' }}</td>
              <td>{{ pick.confidence }}</td>
            </tr>
          {% else %}
            <tr>
              <td colspan="6" class="muted">No hay picks todavía.</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <div class="card">
      <h3>Cómo usarlo</h3>
      <ol>
        <li>Configura tu API key y ajustes en <a href="/ui/settings">/ui/settings</a>.</li>
        <li>Ejecuta la ingesta y enqueue de jobs para el día.</li>
        <li>Arranca el worker para que procese los auto-picks.</li>
      </ol>
      <p class="muted">
        Los picks se generan automáticamente 2 horas antes de cada juego usando OpenAI.
      </p>
    </div>
  </div>
</body>
</html>
