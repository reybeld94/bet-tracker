{% extends "base.html" %}
{% block title %}Settings â€” Bet Tracker{% endblock %}

{% block content %}
<div class="page-header">
  <h1>Auto Picks Settings</h1>
  <p class="subtitle">Configura OpenAI y opciones de auto-picks</p>
</div>

<div class="breadcrumb">
  <a href="/">Dashboard</a>
  <span class="sep">/</span>
  <span>Settings</span>
</div>

{% if saved %}
  <div class="notice notice-success">
    Settings guardados correctamente.
  </div>
{% endif %}

<div class="card" style="max-width:760px;">
  <form method="post" action="/ui/settings">
    <!-- OpenAI API Key -->
    <div class="form-group">
      <label>OpenAI API Key</label>
      <input type="password" name="openai_api_key" placeholder="{{ 'API key almacenada' if has_key else 'sk-...' }}" />
      <div class="form-hint">La API key se guarda encriptada en la base de datos local.</div>
    </div>

    <!-- Model & Reasoning -->
    <div class="form-row">
      <div class="form-group">
        <label>Model</label>
        <input name="openai_model" value="{{ settings.openai_model }}" />
      </div>
      <div class="form-group">
        <label>Reasoning Effort</label>
        <select name="openai_reasoning_effort">
          {% for option in ['low', 'medium', 'high'] %}
            <option value="{{ option }}" {% if settings.openai_reasoning_effort == option %}selected{% endif %}>{{ option|capitalize }}</option>
          {% endfor %}
        </select>
      </div>
    </div>

    <!-- Concurrency & Polling -->
    <div class="form-row">
      <div class="form-group">
        <label>Concurrency</label>
        <input type="number" min="1" name="auto_picks_concurrency" value="{{ settings.auto_picks_concurrency }}" />
        <div class="form-hint">Workers paralelos para procesar picks.</div>
      </div>
      <div class="form-group">
        <label>Poll Seconds</label>
        <input type="number" min="5" name="auto_picks_poll_seconds" value="{{ settings.auto_picks_poll_seconds }}" />
        <div class="form-hint">Intervalo entre chequeo de jobs.</div>
      </div>
    </div>

    <!-- Max Retries -->
    <div class="form-row">
      <div class="form-group">
        <label>Max Retries</label>
        <input type="number" min="0" name="auto_picks_max_retries" value="{{ settings.auto_picks_max_retries }}" />
      </div>
      <div class="form-group"></div>
    </div>

    <!-- Checkboxes -->
    <div class="form-group">
      <label>
        <input type="checkbox" name="auto_picks_enabled" {% if settings.auto_picks_enabled %}checked{% endif %} />
        Auto picks enabled
      </label>
    </div>

    <div class="form-group">
      <label>
        <input type="checkbox" name="allow_totals_default" {% if settings.allow_totals_default %}checked{% endif %} />
        Allow totals by default
      </label>
    </div>

    <!-- Actions -->
    <div class="actions-row mt-2">
      <button type="submit" class="btn btn-primary">Guardar</button>
      <a href="/" class="btn btn-secondary">Volver</a>
    </div>
  </form>
</div>
{% endblock %}
